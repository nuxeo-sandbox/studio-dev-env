apiVersion: skaffold/v2beta2
kind: Config

build:
  artifacts:
    - image: akervern/dev-base
      context: dev-base
      docker: {}
    - image: akervern/project-base
      context: project-base
      docker: {}
    - image: akervern/code-server-base
      context: code-server-base
      docker: {}
    - image: akervern/code-server-project
      context: code-server-project
      docker: {}
    - image: akervern/theia-builder
      context: theia-builder
      docker: {}
    - image: akervern/theia-base
      context: theia-base
      docker: {}
    - image: akervern/theia-project
      context: theia-project
      docker: {}
test:
  - image: akervern:dev-base
    structureTests:
      - ./tests/base-java.yml
      - ./tests/base-nodejs.yml
  - image: akervern:project-base
    structureTests:
      - ./tests/base-entrypoints.yml
  - image: akervern/code-server-base
    structureTests:
      - ./tests/code-server.yml
  - image: akervern/theia-base
    structureTests:
      - ./tests/theia.yml
  - image: akervern/code-server-project
    structureTests:
      - ./tests/base-java.yml
      - ./tests/base-entrypoints.yml
      - ./tests/base-nodejs.yml
      - ./tests/code-server.yml
      - ./tests/code-server-project.yml
  - image: akervern/theia-project
    structureTests:
      - ./tests/base-java.yml
      - ./tests/base-entrypoints.yml
      - ./tests/base-nodejs.yml
      - ./tests/theia.yml
      - ./tests/theia-project.yml

deploy: {}

profiles:
  - name: dev
    activation:
      - command: dev
    build:
      local: { push: false }
      tagPolicy:
        envTemplate:
          template: '{{.IMAGE_NAME}}:latest'
